ssh://bureaux@172.30.2.148:22/home/bureaux/miniconda3/envs/Keras-base/bin/python -u /home/bureaux/Projects/DigestClassification/main.py
Using TensorFlow backend.
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:4185: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:174: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:181: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
Input-Token (InputLayer)        (None, None)         0
__________________________________________________________________________________________________
Input-Segment (InputLayer)      (None, None)         0
__________________________________________________________________________________________________
Embedding-Token (Embedding)     (None, None, 312)    6591936     Input-Token[0][0]
__________________________________________________________________________________________________
Embedding-Segment (Embedding)   (None, None, 312)    624         Input-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Token-Segment (Add)   (None, None, 312)    0           Embedding-Token[0][0]
                                                                 Embedding-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Position (PositionEmb (None, None, 312)    159744      Embedding-Token-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Norm (LayerNormalizat (None, None, 312)    624         Embedding-Position[0][0]
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    390624      Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    0           Embedding-Norm[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    624         Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward (FeedFo (None, None, 312)    780312      Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward-Add (Ad (None, None, 312)    0           Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[1][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[2][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[3][0]
__________________________________________________________________________________________________
Transformer-FeedForward-Norm (L (None, None, 312)    624         Transformer-FeedForward-Add[0][0]
                                                                 Transformer-FeedForward-Add[1][0]
                                                                 Transformer-FeedForward-Add[2][0]
                                                                 Transformer-FeedForward-Add[3][0]
__________________________________________________________________________________________________
CLS-token (Lambda)              (None, 312)          0           Transformer-FeedForward-Norm[3][0
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 3)            939         CLS-token[0][0]
==================================================================================================
Total params: 7,926,051
Trainable params: 7,926,051
Non-trainable params: 0
__________________________________________________________________________________________________
WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where

batch_token_ids shape:  (128, 172)
batch_segment_ids shape: (128, 172)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 174)
batch_segment_ids shape: (128, 174)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 194)
batch_segment_ids shape: (128, 194)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 183)
batch_segment_ids shape: (128, 183)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 165)
batch_segment_ids shape: (128, 165)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 172)
batch_segment_ids shape: (128, 172)
batch_labels shape: (128, 1)
Epoch 1/200
29/29 [==============================] - 42s 1s/step - loss: 1.1474 - sparse_categorical_accuracy: 0.2840 - val_loss: 1.0491 - val_sparse_categorical_accuracy: 0.5492
val_acc: 0.54923, best_val_acc: 0.54923, test_acc: 0.56600

Epoch 2/200
29/29 [==============================] - 22s 752ms/step - loss: 1.0886 - sparse_categorical_accuracy: 0.4302 - val_loss: 1.0140 - val_sparse_categorical_accuracy: 0.4748
val_acc: 0.47484, best_val_acc: 0.54923, test_acc: 0.49194

Epoch 3/200
29/29 [==============================] - 22s 756ms/step - loss: 1.0347 - sparse_categorical_accuracy: 0.4798 - val_loss: 0.9747 - val_sparse_categorical_accuracy: 0.4530
val_acc: 0.45295, best_val_acc: 0.54923, test_acc: 0.48073

Epoch 4/200
29/29 [==============================] - 22s 759ms/step - loss: 1.0002 - sparse_categorical_accuracy: 0.4775 - val_loss: 0.9114 - val_sparse_categorical_accuracy: 0.5908
val_acc: 0.59081, best_val_acc: 0.59081, test_acc: 0.59634

Epoch 5/200
29/29 [==============================] - 23s 786ms/step - loss: 0.9232 - sparse_categorical_accuracy: 0.5475 - val_loss: 0.7702 - val_sparse_categorical_accuracy: 0.8053
val_acc: 0.80525, best_val_acc: 0.80525, test_acc: 0.81334

Epoch 6/200
29/29 [==============================] - 25s 846ms/step - loss: 0.7728 - sparse_categorical_accuracy: 0.7546 - val_loss: 0.5447 - val_sparse_categorical_accuracy: 0.8359
val_acc: 0.83589, best_val_acc: 0.83589, test_acc: 0.84121

Epoch 7/200
29/29 [==============================] - 26s 907ms/step - loss: 0.5505 - sparse_categorical_accuracy: 0.8323 - val_loss: 0.3430 - val_sparse_categorical_accuracy: 0.9322
val_acc: 0.93217, best_val_acc: 0.93217, test_acc: 0.94671

Epoch 8/200
29/29 [==============================] - 28s 959ms/step - loss: 0.3527 - sparse_categorical_accuracy: 0.9194 - val_loss: 0.2047 - val_sparse_categorical_accuracy: 0.9694
val_acc: 0.96937, best_val_acc: 0.96937, test_acc: 0.97267

Epoch 9/200
29/29 [==============================] - 27s 936ms/step - loss: 0.2239 - sparse_categorical_accuracy: 0.9623 - val_loss: 0.1222 - val_sparse_categorical_accuracy: 0.9934
val_acc: 0.99344, best_val_acc: 0.99344, test_acc: 0.99235

Epoch 10/200
29/29 [==============================] - 29s 986ms/step - loss: 0.1434 - sparse_categorical_accuracy: 0.9820 - val_loss: 0.0789 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99426

Epoch 11/200
29/29 [==============================] - 29s 994ms/step - loss: 0.1000 - sparse_categorical_accuracy: 0.9874 - val_loss: 0.0569 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99426

Epoch 12/200
29/29 [==============================] - 28s 974ms/step - loss: 0.0776 - sparse_categorical_accuracy: 0.9907 - val_loss: 0.0469 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99426

Epoch 13/200
29/29 [==============================] - 29s 1s/step - loss: 0.0616 - sparse_categorical_accuracy: 0.9925 - val_loss: 0.0405 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99453

Epoch 14/200
29/29 [==============================] - 29s 987ms/step - loss: 0.0528 - sparse_categorical_accuracy: 0.9916 - val_loss: 0.0358 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99508

Epoch 15/200
29/29 [==============================] - 29s 1s/step - loss: 0.0461 - sparse_categorical_accuracy: 0.9941 - val_loss: 0.0327 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99508

Epoch 16/200
29/29 [==============================] - 29s 989ms/step - loss: 0.0427 - sparse_categorical_accuracy: 0.9938 - val_loss: 0.0305 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99508

Epoch 17/200
29/29 [==============================] - 30s 1s/step - loss: 0.0391 - sparse_categorical_accuracy: 0.9943 - val_loss: 0.0289 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99508

Epoch 18/200
29/29 [==============================] - 29s 1s/step - loss: 0.0362 - sparse_categorical_accuracy: 0.9942 - val_loss: 0.0279 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99508

Epoch 19/200
29/29 [==============================] - 29s 999ms/step - loss: 0.0324 - sparse_categorical_accuracy: 0.9946 - val_loss: 0.0267 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99590

Epoch 20/200
29/29 [==============================] - 29s 1s/step - loss: 0.0290 - sparse_categorical_accuracy: 0.9954 - val_loss: 0.0242 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99590

Epoch 21/200
29/29 [==============================] - 30s 1s/step - loss: 0.0288 - sparse_categorical_accuracy: 0.9954 - val_loss: 0.0253 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 22/200
29/29 [==============================] - 29s 995ms/step - loss: 0.0246 - sparse_categorical_accuracy: 0.9960 - val_loss: 0.0219 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 23/200
29/29 [==============================] - 29s 1s/step - loss: 0.0210 - sparse_categorical_accuracy: 0.9968 - val_loss: 0.0212 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 24/200
29/29 [==============================] - 30s 1s/step - loss: 0.0195 - sparse_categorical_accuracy: 0.9968 - val_loss: 0.0195 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 25/200
29/29 [==============================] - 30s 1s/step - loss: 0.0185 - sparse_categorical_accuracy: 0.9966 - val_loss: 0.0203 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 26/200
29/29 [==============================] - 29s 999ms/step - loss: 0.0165 - sparse_categorical_accuracy: 0.9968 - val_loss: 0.0174 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 27/200
29/29 [==============================] - 29s 1s/step - loss: 0.0149 - sparse_categorical_accuracy: 0.9970 - val_loss: 0.0179 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99754

Epoch 28/200
29/29 [==============================] - 30s 1s/step - loss: 0.0142 - sparse_categorical_accuracy: 0.9968 - val_loss: 0.0174 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99781

Epoch 29/200
29/29 [==============================] - 29s 995ms/step - loss: 0.0133 - sparse_categorical_accuracy: 0.9970 - val_loss: 0.0186 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99754

Epoch 30/200
29/29 [==============================] - 29s 1s/step - loss: 0.0124 - sparse_categorical_accuracy: 0.9970 - val_loss: 0.0167 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99809

Epoch 31/200
29/29 [==============================] - 30s 1s/step - loss: 0.0117 - sparse_categorical_accuracy: 0.9970 - val_loss: 0.0155 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99891

Epoch 32/200
29/29 [==============================] - 28s 964ms/step - loss: 0.0102 - sparse_categorical_accuracy: 0.9970 - val_loss: 0.0157 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99918

Epoch 33/200
29/29 [==============================] - 30s 1s/step - loss: 0.0093 - sparse_categorical_accuracy: 0.9973 - val_loss: 0.0162 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99945

Epoch 34/200
29/29 [==============================] - 29s 1s/step - loss: 0.0085 - sparse_categorical_accuracy: 0.9981 - val_loss: 0.0162 - val_sparse_categorical_accuracy: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99945

Epoch 00034: early stopping
final test acc: 0.998907


进程已结束,退出代码0
