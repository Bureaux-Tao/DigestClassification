ssh://bureaux@172.30.2.148:22/home/bureaux/miniconda3/envs/Keras-base/bin/python -u /home/bureaux/Projects/DigestClassification/main.py
Using TensorFlow backend.
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:4185: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:174: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:181: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
Input-Token (InputLayer)        (None, None)         0
__________________________________________________________________________________________________
Input-Segment (InputLayer)      (None, None)         0
__________________________________________________________________________________________________
Embedding-Token (Embedding)     (None, None, 312)    6591936     Input-Token[0][0]
__________________________________________________________________________________________________
Embedding-Segment (Embedding)   (None, None, 312)    624         Input-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Token-Segment (Add)   (None, None, 312)    0           Embedding-Token[0][0]
                                                                 Embedding-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Position (PositionEmb (None, None, 312)    159744      Embedding-Token-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Norm (LayerNormalizat (None, None, 312)    624         Embedding-Position[0][0]
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    390624      Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    0           Embedding-Norm[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    624         Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward (FeedFo (None, None, 312)    780312      Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward-Add (Ad (None, None, 312)    0           Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[1][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[2][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[3][0]
__________________________________________________________________________________________________
Transformer-FeedForward-Norm (L (None, None, 312)    624         Transformer-FeedForward-Add[0][0]
                                                                 Transformer-FeedForward-Add[1][0]
                                                                 Transformer-FeedForward-Add[2][0]
                                                                 Transformer-FeedForward-Add[3][0]
__________________________________________________________________________________________________
CLS-token (Lambda)              (None, 312)          0           Transformer-FeedForward-Norm[3][0
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 3)            939         CLS-token[0][0]
==================================================================================================
Total params: 7,926,051
Trainable params: 7,926,051
Non-trainable params: 0
__________________________________________________________________________________________________
WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where

batch_token_ids shape:  (128, 172)
batch_segment_ids shape: (128, 172)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 174)
batch_segment_ids shape: (128, 174)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 194)
batch_segment_ids shape: (128, 194)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 183)
batch_segment_ids shape: (128, 183)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 165)
batch_segment_ids shape: (128, 165)
batch_labels shape: (128, 1)

batch_token_ids shape:  (128, 172)
batch_segment_ids shape: (128, 172)
batch_labels shape: (128, 1)
Epoch 1/200
29/29 [==============================] - 19s 643ms/step - loss: 1.1703 - acc: 0.2036 - val_loss: 1.0676 - val_acc: 0.4705
val_acc: 0.47046, best_val_acc: 0.47046, test_acc: 0.49440

Epoch 2/200
29/29 [==============================] - 11s 374ms/step - loss: 1.1187 - acc: 0.3962 - val_loss: 1.0310 - val_acc: 0.4551
val_acc: 0.45514, best_val_acc: 0.47046, test_acc: 0.48101

Epoch 3/200
29/29 [==============================] - 10s 361ms/step - loss: 1.0548 - acc: 0.4824 - val_loss: 1.0004 - val_acc: 0.4530
val_acc: 0.45295, best_val_acc: 0.47046, test_acc: 0.48046

Epoch 4/200
29/29 [==============================] - 10s 357ms/step - loss: 1.0201 - acc: 0.4862 - val_loss: 0.9531 - val_acc: 0.5186
val_acc: 0.51860, best_val_acc: 0.51860, test_acc: 0.53949

Epoch 5/200
29/29 [==============================] - 11s 382ms/step - loss: 0.9688 - acc: 0.5212 - val_loss: 0.8474 - val_acc: 0.5974
val_acc: 0.59737, best_val_acc: 0.59737, test_acc: 0.61711

Epoch 6/200
29/29 [==============================] - 12s 428ms/step - loss: 0.8677 - acc: 0.6361 - val_loss: 0.6375 - val_acc: 0.8140
val_acc: 0.81400, best_val_acc: 0.81400, test_acc: 0.82345

Epoch 7/200
29/29 [==============================] - 11s 393ms/step - loss: 0.6570 - acc: 0.7737 - val_loss: 0.4323 - val_acc: 0.8928
val_acc: 0.89278, best_val_acc: 0.89278, test_acc: 0.90653

Epoch 8/200
29/29 [==============================] - 13s 441ms/step - loss: 0.4313 - acc: 0.8830 - val_loss: 0.2570 - val_acc: 0.9650
val_acc: 0.96499, best_val_acc: 0.96499, test_acc: 0.97404

Epoch 9/200
29/29 [==============================] - 14s 490ms/step - loss: 0.2656 - acc: 0.9588 - val_loss: 0.1476 - val_acc: 0.9912
val_acc: 0.99125, best_val_acc: 0.99125, test_acc: 0.99153

Epoch 10/200
29/29 [==============================] - 13s 457ms/step - loss: 0.1602 - acc: 0.9791 - val_loss: 0.0921 - val_acc: 0.9912
val_acc: 0.99125, best_val_acc: 0.99125, test_acc: 0.99344

Epoch 11/200
29/29 [==============================] - 12s 429ms/step - loss: 0.1117 - acc: 0.9823 - val_loss: 0.0653 - val_acc: 0.9912
val_acc: 0.99125, best_val_acc: 0.99125, test_acc: 0.99426

Epoch 12/200
29/29 [==============================] - 13s 454ms/step - loss: 0.0798 - acc: 0.9871 - val_loss: 0.0509 - val_acc: 0.9912
val_acc: 0.99125, best_val_acc: 0.99125, test_acc: 0.99481

Epoch 13/200
29/29 [==============================] - 12s 420ms/step - loss: 0.0684 - acc: 0.9883 - val_loss: 0.0408 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99535

Epoch 14/200
29/29 [==============================] - 14s 475ms/step - loss: 0.0554 - acc: 0.9909 - val_loss: 0.0354 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99617

Epoch 15/200
29/29 [==============================] - 14s 466ms/step - loss: 0.0487 - acc: 0.9916 - val_loss: 0.0310 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 16/200
29/29 [==============================] - 13s 441ms/step - loss: 0.0420 - acc: 0.9933 - val_loss: 0.0274 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 17/200
29/29 [==============================] - 13s 436ms/step - loss: 0.0388 - acc: 0.9925 - val_loss: 0.0255 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 18/200
29/29 [==============================] - 13s 457ms/step - loss: 0.0334 - acc: 0.9949 - val_loss: 0.0246 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 19/200
29/29 [==============================] - 15s 509ms/step - loss: 0.0287 - acc: 0.9968 - val_loss: 0.0218 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 20/200
29/29 [==============================] - 12s 426ms/step - loss: 0.0271 - acc: 0.9957 - val_loss: 0.0212 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 21/200
29/29 [==============================] - 13s 444ms/step - loss: 0.0242 - acc: 0.9965 - val_loss: 0.0201 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 22/200
29/29 [==============================] - 13s 445ms/step - loss: 0.0235 - acc: 0.9962 - val_loss: 0.0194 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 23/200
29/29 [==============================] - 13s 458ms/step - loss: 0.0211 - acc: 0.9968 - val_loss: 0.0175 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 24/200
29/29 [==============================] - 13s 442ms/step - loss: 0.0190 - acc: 0.9966 - val_loss: 0.0179 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 25/200
29/29 [==============================] - 13s 459ms/step - loss: 0.0184 - acc: 0.9962 - val_loss: 0.0182 - val_acc: 0.9956
val_acc: 0.99562, best_val_acc: 0.99562, test_acc: 0.99699

Epoch 00025: early stopping
final test acc: 0.996994


进程已结束,退出代码0
